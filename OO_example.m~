% initialize simulation if hasn't already been initialized
if isempty(s)
    s = simulation;
end
% compute the fields if haven't already been calculated, these are now stored in s along with other goodies
if isempty(s.fields)
    s.compute_fields;
end

% define input phase space vector
in = [s.dl s.W/2 s.beta*s.me*s.c0 0];
% scan through different phis and draw the trajectoroes
NP = 200;
phis = rand(NP,1);
upd = textprogressbar(NP);
clf; hold all;
for i = (1:NP)
    upd(i);
    [out, traj] = s.propagate_particle(in, phis(i));    
    plot(traj(1,:),traj(2,:))
end

xpoints = 
xlabel('x position');
ylabel('y position');
